/**
 * @title elq.js
 * @overview Parses CSS for element queries, supports them in JavaScript
 * @copyright (c) 2014
 * @license CC BY (http://creativecommons.org/licenses/by/4.0/)
 * @author Art Lawry
*/
window.elq=function(a,b){"use strict";var c,d,e=0,f={},g={},h=new RegExp("\\s*([^,}]+)\\:media\\(((?:(?:(?:\\s*not)?\\s*(?:\\([^)]+\\))(?:\\s*and\\s*(?:\\([^)]+\\)))*)(?:\\s*,(?:\\s*not)\\s*(?:\\([^)]+\\))(?:\\s*and\\s*(?:\\([^)]+\\)))*)*|[^())]+))\\)","g"),i={};return a._revealed=i,i.fetchExternalCSS=function(a){var c,d,g=!1,h=a.getAttribute("href"),j=a.getAttribute("media")||"";return f[h+j]?e-=1:(g=!0,c=b.createElement("style"),d=new XMLHttpRequest,j&&c.setAttribute("media",j),c.setAttribute("href",h),c.className="elq-fetched",a.parentNode.insertBefore(c,a.nextSibling),f[h+j]=!0,d.onreadystatechange=function(){4===d.readyState&&(200===d.status?c.innerHTML+=d.responseText:i.unfetchExternalCSS(a),e-=1,e||i.parseCSS())},d.open("GET",h,!0),d.send()),g},i.unfetchExternalCSS=function(a){var b=!1,c=a.getAttribute("href"),d=a.getAttribute("media")||"",e=a.nextSibling;return e&&"style"===e.tagName.toLowerCase()&&a.getAttribute("href")===e.getAttribute("href")&&a.getAttribute("media")===e.getAttribute("media")&&"elq-fetched"===e.className&&(e.parentNode.removeChild(e),delete f[c+d],b=!0),b},i.applyContext=function(){var a,c,e,f=Object.keys(g),h=f.length;for(e=function(a,b,c,e,f){var h,i=g[a],j=Object.keys(i),k=j.length;for(h=0;k>h;h+=1)i[j[h]](e,f,c,b,d)},c=function(a){var c,d,f,g,h,i,j=b.querySelectorAll(a),k=j.length;for(c=0;k>c;c+=1)d=j[c],f=d.parentNode,g=b.defaultView.getComputedStyle(f,null).getPropertyValue("fontSize"),h=f.clientWidth,h+=2*(parseInt(f.style.padding,10)||0),h+=parseInt(f.style.paddingLeft,10)||0,h+=parseInt(f.style.paddingRight,10)||0,i=f.clientHeigparentHeightt,i+=2*(parseInt(f.style.padding,10)||0),i+=parseInt(f.style.paddingTop,10)||0,i+=parseInt(f.style.paddingBottom,10)||0,e(a,g,d,h,i)},a=0;h>a;a+=1)c(f[a]);return h?!0:!1},i.respondToContext=function(){var a=function(){clearTimeout(c),c=setTimeout(i.respondToContext,300)};return d=b.defaultView.getComputedStyle(b.querySelector("html"),null).getPropertyValue("fontSize"),window.removeEventListener("resize",a),window.removeEventListener("orientationchange",a),window.addEventListener("resize",a),window.addEventListener("orientationchange",a),i.applyContext()},i.parseCSS=function(){var c,d,e,f=!1,g=b.querySelectorAll("style"),j=g.length,k=function(b,c,d){return c+"."+a.register(c,d)};for(c=0;j>c;c+=1){for(d=g[c],e=d.innerHTML,e=e.replace(/\s+/g," "),e=e.replace(/(^|\})\s*/g,"$1\n");h.test(e);)f=!0,e=e.replace(h,k);d.innerHTML=e}return i.respondToContext(),f},i.mediaToCondition=function(a){for(a="("+a+")",a=a.replace(/\s*,\s*/g,")||("),a=a.replace(/\s*not\s*([^|]+)\s*/g,"!($1)"),a=a.replace(/\s+and\s+/g,"&&"),a=a.replace(/\s*(?:(min|max)-)?(width|height)\s*:\s*(\d+)(px|em|rem)\s*/g,function(a,b,c,d,e){var f,g,h;return f="min"===b?">=":"max"===b?"<=":"==",g="width"===c?"elw":"elh",h=d,"em"===e?g="("+g+"/pxpem)":"rem"===e&&(g="("+g+"/pxprem)"),g+f+h}),a=a.replace(/\s*(?:(min|max)-)?aspect-ratio\s*:\s*(\S+)\s*/g,function(a,b,c){var d,e,f;return d="min"===b?">=":"max"===b?"<=":"==",e="(elw/elh)",f=c,e+d+f});/\(\(([^)]+)\)\)/.test(a);)a=a.replace(/\(\(([^)]+)\)\)/g,"($1)");return a},a.register=function(a,b,c){return a&&b&&(c||(c=b.replace(/^\W*(\w.*\w)\W*$/,function(a,b){return b=b.replace(/\W+/g,"-"),"elq-"+b})),g[a]||(g[a]={}),g[a][b]=new Function("elw","elh","el","pxpem","pxprem","el.className = el.className.replace(/(^|\\s)"+c+"($|\\s)/g,'$2');if ("+i.mediaToCondition(b)+") {el.className += el.className ? ' ' : '';el.className += '"+c+"';}")),i.respondToContext(),c},a.unregister=function(a,b){var c=!1;return a&&b?(c=g[a][b]?!0:!1,delete g[a][b]):(c=Object.keys(g).length?!0:!1,g={}),c},a.process=function(a){var c,d;if(a=a||b.querySelectorAll('link[href*=".css"]'),c=a.length,e=c,c)for(d=0;c>d;d+=1)i.fetchExternalCSS(a[d]);else i.parseCSS();return!0},a}(window.elq||{},document);
//# sourceMappingURL=elq.min.js.map