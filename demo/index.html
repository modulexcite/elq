<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Demo</title>
    <style>
      .wrapper {
        width: 1024px;
        margin: 0 auto;
      }
      #column {
        width: 199px;
      }
      #pages {
        width: 299px;
      }
      #tabs {
        width: 499px;
      }
      #small {
        font-size: 1rem;
        display: inline-block;
        vertical-align: top;
        width: 25%;
      }
      #medium {
        font-size: 1rem;
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
      #large {
        font-size: 1rem;
        display: inline-block;
        vertical-align: top;
        width: 75%;
      }
      #full {
        font-size: 1rem;
        display: inline-block;
        vertical-align: top;
        width: 100%;
      }
      #morph {
        height: 550px;
        width: 199px;
        display: none;
        -webkit-transition: width 2s;
        transition: width 2s;
        border-right: 4px dotted red;
        border-left: 4px dotted red;
        margin-left: -4px;
        margin-right: -4px;
      }

      body {
        line-height: 1.5em;
        font-family: Helvetica, Arial, sans-serif;
      }

      h1 {
        font-size: 2rem;
        margin: 1em 0;
        padding: 0;
      }

      h2 {
        font-size: 1.5rem;
        margin: 1em 0;
        padding: 0;
      }

      .groups {
        padding: 0 4px 4px 4px;
        margin-top: 1em;
      }
      .groups .label {
        font-weight: normal;
        font-size: 1em;
        margin: 0;
        padding: .5em;
        background-color: #ddd;
        border-top: 4px solid #fff;
        border-bottom: 4px solid #fff;
      }
      .groups .panel {
        background-color: #eee;
        padding: .5em;
        margin: 0;
        list-style: none;
      }
      .groups .tab {
        display: none;
      }
      .groups .button {
        display: none;
      }

      .groups:media(min-width: 200px) {
        text-align: center;
        padding: 4px;
        position: relative;
      }
      .groups:media(min-width: 200px) .label {
        display: none;
      }
      .groups:media(min-width: 200px) .tab {
        font-weight: normal;
        font-size: 1em;
        margin: 0;
        padding: .5em;
        vertical-align: top;
        display: none;
        background-color: #eee;
        cursor: pointer;
        cursor: hand;
      }
      .groups:media(min-width: 200px) .tab.active {
        background-color: #ddd;
        border-bottom: 4px solid #fff;
        display: block;
        cursor: default;
      }
      .groups:media(min-width: 200px) .button {
        position: absolute;
        font-weight: normal;
        font-size: 1em;
        margin: 0;
        padding: .5em;
        vertical-align: top;
        display: inline-block;
        background-color: #eee;
        height: 1.5em;
        width: 1.5em;
        cursor: pointer;
        cursor: hand;
        border: 4px solid #fff;
        top: 0;
      }
      .groups:media(min-width: 200px) .button.prev {
        left: 0;
      }
      .groups:media(min-width: 200px) .button.next {
        right: 0;
      }
      .groups:media(min-width: 200px) .button:before {
        content: '';
        position: absolute;
        top: .75em;
        border: .5em solid transparent;
        line-height: 0;
      }
      .groups:media(min-width: 200px) .button.prev:before {
        left: .5em;
        border-right-color: #333;
      }
      .groups:media(min-width: 200px) .button.next:before {
        right: .5em;
        border-left-color: #333;
      }
      .groups:media(min-width: 200px) .panel {
        text-align: left;
        display: none;
      }
      .groups:media(min-width: 200px) .panel.active {
        display: block;
        background-color: #ddd;
      }

      .groups:media(min-width: 400px) {
        text-align: left;
      }
      .groups:media(min-width: 400px) .tab {
        display: inline-block;
      }
      .groups:media(min-width: 400px) .tab.active {
        display: inline-block;
        border-bottom: 4px solid #ddd;
      }
      .groups:media(min-width: 400px) .button {
        display: none;
      }
    </style>
  </head>
  <body>

    <div class="wrapper">

      <h1>elq.js Example: Tabbed Content</h1>

      <div id="morph">
        <div class="groups">
          <h3 class="label">Stark</h3>
          <ul class="panel">
            <li>Eddard</li>
            <li>Catelyn</li>
            <li>Robb</li>
            <li>Sansa</li>
            <li>Brandon</li>
            <li>Arya</li>
            <li>Rickon</li>
          </ul>
          <h3 class="label">Lannister</h3>
          <ul class="panel">
            <li>Tywin</li>
            <li>Cersei</li>
            <li>Jamie</li>
            <li>Tyrion</li>
          </ul>
          <h3 class="label">Targaryen</h3>
          <ul class="panel">
            <li>Viserys</li>
            <li>Daenerys</li>
          </ul>
        </div>
      </div>

      <p>elq.js renders the same html differently based on the context of the container in which that html is rendered. In this example, a series of lists with headings will be rendered differently based on the width of its rendering environment. The breakpoints are as follows:</p>

      <section>

        <h2>Serialized</h2>

        <p>When the container width is less than 200 pixels, content will be serialized. This is the default state of the content from which the other break points will be enhanced.</p>

        <div id="column">
          <div class="groups">
            <h3 class="label">Stark</h3>
            <ul class="panel">
              <li>Eddard</li>
              <li>Catelyn</li>
              <li>Robb</li>
              <li>Sansa</li>
              <li>Brandon</li>
              <li>Arya</li>
              <li>Rickon</li>
            </ul>
            <h3 class="label">Lannister</h3>
            <ul class="panel">
              <li>Tywin</li>
              <li>Cersei</li>
              <li>Jamie</li>
              <li>Tyrion</li>
            </ul>
            <h3 class="label">Targaryen</h3>
            <ul class="panel">
              <li>Viserys</li>
              <li>Daenerys</li>
            </ul>
          </div>
        </div>

      </section>

      <section>

        <h2>Paged</h2>

        <p>Above 200 pixels but below 400 pixels content will be paginated. There isn't enough room for tabs, but there should be enough room to shrink the vertical footprint of serialized data.</p>

        <p><em>:media(min-width: 200px)</em> is used to style content at this breakpoint.</p>

        <p>JavaScript listens for an <em>elq-change</em> event and builds the necessary interface components (duplicate labels, paging buttons) if the conditions are met. This enhancement won't occurr if the content never enters this particular breakpoint, but will only occur once should it ever enter the breakpoint.</p>

        <div id="pages">
          <div class="groups">
            <h3 class="label">Stark</h3>
            <ul class="panel">
              <li>Eddard</li>
              <li>Catelyn</li>
              <li>Robb</li>
              <li>Sansa</li>
              <li>Brandon</li>
              <li>Arya</li>
              <li>Rickon</li>
            </ul>
            <h3 class="label">Lannister</h3>
            <ul class="panel">
              <li>Tywin</li>
              <li>Cersei</li>
              <li>Jamie</li>
              <li>Tyrion</li>
            </ul>
            <h3 class="label">Targaryen</h3>
            <ul class="panel">
              <li>Viserys</li>
              <li>Daenerys</li>
            </ul>
          </div>
        </div>

      </section>

      <section>

        <h2>Tabbed</h2>

        <p>Above 400 pixels content will be tabbed.</p>

        <p><em>:media(min-width: 400px)</em> is used to style content at this breakpoint.</p>

        <p>JavaScript listens for an <em>elq-change</em> event and builds the necessary interface components (duplicate labels) if the conditions are met. This enhancement won't occurr if the content never enters this particular breakpoint, but will only occur once should it ever enter the breakpoint.</p>

        <div id="tabs">
          <div class="groups">
            <h3 class="label">Stark</h3>
            <ul class="panel">
              <li>Eddard</li>
              <li>Catelyn</li>
              <li>Robb</li>
              <li>Sansa</li>
              <li>Brandon</li>
              <li>Arya</li>
              <li>Rickon</li>
            </ul>
            <h3 class="label">Lannister</h3>
            <ul class="panel">
              <li>Tywin</li>
              <li>Cersei</li>
              <li>Jamie</li>
              <li>Tyrion</li>
            </ul>
            <h3 class="label">Targaryen</h3>
            <ul class="panel">
              <li>Viserys</li>
              <li>Daenerys</li>
            </ul>
          </div>
        </div>

      </section>

    </div>

    <script>
      var
        groups = document.querySelectorAll('.groups'),
        jlen = groups.length,
        j = 0;

      function addTabs (el) {
        var
          labels = el.querySelectorAll('.label'),
          clone,
          space,
          i = labels.length - 1;

        if (!el.querySelectorAll('.tab').length) {

          for (; i >= 0; i -= 1) {
            space = document.createTextNode(' ');
            el.insertBefore(space, el.firstChild);

            clone = labels[i].cloneNode(true);
            clone.className = clone.className.replace(/label/, 'tab');
            clone.setAttribute('tab-index', i);
            if (i === 0) {
              clone.className += ' active';
            }
            el.insertBefore(clone, el.firstChild);

            clone.addEventListener('click', function(e) {
              var
                i = 0,
                panels = e.target.parentNode.querySelectorAll('.panel'),
                tabs = e.target.parentNode.querySelectorAll('.tab');

              for (i = 0; i < panels.length; i += 1) {
                panels[i].className =
                  panels[i].className.replace(/\s*active/, '');
                tabs[i].className =
                  tabs[i].className.replace(/\s*active/, '');

                if (i === +(e.target.getAttribute('tab-index'))) {
                  panels[i].className += ' active';
                  tabs[i].className += ' active';
                }
              }

            });
          }

          el.querySelectorAll('.panel')[0].className += ' active';

        }

      }

      function hasButtons (el) {
        return el.querySelectorAll('.button').length ? true : false;
      }

      function addButtons (el) {
        var
          panels = el.querySelectorAll('.panel'),
          space,
          prev,
          next;

        if (!el.querySelectorAll('.button').length) {

          space = document.createTextNode(' ');
          prev = document.createElement('div');
          prev.className = 'button prev';
          el.insertBefore(space, el.firstChild);
          el.insertBefore(prev, el.firstChild);

          space = document.createTextNode(' ');
          next = document.createElement('div');
          next.className = 'button next';
          el.insertBefore(space, panels[0]);
          el.insertBefore(next, panels[0]);

          prev.addEventListener('click', function(e) {
            var
              i = e.target.parentNode.querySelectorAll('.active.tab')[0]
                .getAttribute('tab-index'),
              panels = e.target.parentNode.querySelectorAll('.panel'),
              tabs = e.target.parentNode.querySelectorAll('.tab');

            if (i > 0) {
              panels[i].className =
                panels[i].className.replace(/\s*active/, '');
              tabs[i].className =
                tabs[i].className.replace(/\s*active/, '');
              panels[i - 1].className += ' active';
              tabs[i - 1].className += ' active';
            } else {
              panels[i].className =
                panels[i].className.replace(/\s*active/, '');
              tabs[i].className =
                tabs[i].className.replace(/\s*active/, '');
              panels[panels.length - 1].className += ' active';
              tabs[tabs.length - 1].className += ' active';
            }
          });

          next.addEventListener('click', function(e) {
            var
              i = e.target.parentNode.querySelectorAll('.active.tab')[0]
                .getAttribute('tab-index'),
              panels = e.target.parentNode.querySelectorAll('.panel'),
              tabs = e.target.parentNode.querySelectorAll('.tab');

            if (+i + 1 < tabs.length) {
              panels[i].className =
                panels[i].className.replace(/\s*active/, '');
              tabs[i].className =
                tabs[i].className.replace(/\s*active/, '');
              panels[+i + 1].className += ' active';
              tabs[+i + 1].className += ' active';
            } else {
              panels[i].className =
                panels[i].className.replace(/\s*active/, '');
              tabs[i].className =
                tabs[i].className.replace(/\s*active/, '');
              panels[0].className += ' active';
              tabs[0].className += ' active';
            }
          });

        }

      }

      for (; j < jlen; j += 1) {
        groups[j].addEventListener('elq-change', function(e) {
          if (/elq-min-width/.test(e.target.className)) {
            addTabs(e.target);
          }
          if (/elq-min-width-200px/.test(e.target.className)) {
            addButtons(e.target);
          }
        });
      }
    </script>
    <script src="../dist/elq.js"></script>
    <script>
      elq.process();

      function grow() {
        document.getElementById('morph').style.width = '1024px';
        setTimeout(shrink, 4000);
      }

      function shrink() {
        document.getElementById('morph').style.width = '199px';
        setTimeout(grow, 4000);
      }

      var demoInterval = window.setInterval(elq.respond, 100);

      document.getElementById('morph').style.display = 'block';
      grow();
    </script>
  </body>
</html>
